<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Work on 知乎</title><link>https://www.zhihu.hk/tags/work/</link><description>Recent content in Work on 知乎</description><generator>Hugo</generator><language>zh-CN</language><lastBuildDate>Thu, 24 Mar 2022 21:55:00 +0800</lastBuildDate><atom:link href="https://www.zhihu.hk/tags/work/index.xml" rel="self" type="application/rss+xml"/><item><title>阿里云日志平台使用</title><link>https://www.zhihu.hk/Use-of-Alibaba-Cloud-Logging-Platform.html</link><pubDate>Thu, 24 Mar 2022 21:55:00 +0800</pubDate><guid>https://www.zhihu.hk/Use-of-Alibaba-Cloud-Logging-Platform.html</guid><description>&lt;pre tabindex="0">&lt;code>💡 根据 遗忘曲线：如果没有记录和回顾，6天后便会忘记75%的内容
 读书笔记正是帮助你记录和回顾的工具，不必拘泥于形式，其核心是：记录、翻看、思考
&lt;/code>&lt;/pre>&lt;h2 id="1关键点说明">1、关键点说明&lt;/h2>
&lt;ul>
&lt;li>模糊匹配支持*，但是不支持前模糊匹配&lt;/li>
&lt;li>not 表示非&lt;/li>
&lt;li>可以支持多文档匹配，但是需要注意转义&lt;/li>
&lt;li>| 后面写的的类似sql&lt;/li>
&lt;li>SELECT json_extract(json, &amp;lsquo;$.store.book&amp;rsquo;); 从一个JSON对象中提取值&lt;/li>
&lt;li>json_parse(string) 把字符串转化成JSON类型&lt;/li>
&lt;/ul>
&lt;h2 id="2关键日志查询">2、关键日志查询&lt;/h2>
&lt;ul>
&lt;li>关键函数 &lt;a href="https://help.aliyun.com/document_detail/86661.html?spm=a2c4g.11186623.6.835.4b1a209bfdsjdD">https://help.aliyun.com/document_detail/86661.html?spm=a2c4g.11186623.6.835.4b1a209bfdsjdD&lt;/a>&lt;/li>
&lt;li>json函数 &lt;a href="https://help.aliyun.com/document_detail/63454.html?spm=a2c4g.11186623.6.822.3675209bNQeXZE">https://help.aliyun.com/document_detail/63454.html?spm=a2c4g.11186623.6.822.3675209bNQeXZE&lt;/a>&lt;/li>
&lt;li>环比函数 &lt;a href="https://help.aliyun.com/document_detail/86661.html?spm=a2c4g.11186623.6.845.2d1522fddGPrnq">https://help.aliyun.com/document_detail/86661.html?spm=a2c4g.11186623.6.845.2d1522fddGPrnq&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="3提取日志中的某一个字段">3、提取日志中的某一个字段&lt;/h2>
&lt;pre tabindex="0">&lt;code>ListenAccountIdRefreshedEvent.message&amp;#34; and ProjectName: smlvpc | select DISTINCT regexp_extract(Content, &amp;#39;,&amp;#34;ouid&amp;#34;:&amp;#34;(\S+)&amp;#34;,&amp;#34;uuid&amp;#34;:&amp;#39;, 1)
&lt;/code>&lt;/pre>&lt;h2 id="4阶段统计">4、阶段统计&lt;/h2>
&lt;div class="highlight">&lt;div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-plain" data-lang="plain">&lt;span style="display:flex;">&lt;span>* and url: createFlowOneStep and status=200 | select
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> k,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> v
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>from(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> select
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> map(array [0.5,0.9,0.99,0.999], p) as m
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> from(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> select
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> approx_percentile(duration, array [0.5,0.9,0.99,0.999]) as p
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> FROM log
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> )
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ),
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> unnest(m) as t(k, v)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item></channel></rss>